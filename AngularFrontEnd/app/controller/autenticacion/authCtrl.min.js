app.controller("authCtrl",function(e,o,a,t,n,s,i,r,l,c,d){ 
    e.imageCST="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAAFCAIAAADtz9qMAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAbSURBVBhXY3growJHIM5/GIBy0GWgHCiSUQEAe00iZYBvZ5oAAAAASUVORK5CYII=",e.imageLNG="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAAFCAIAAADtz9qMAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAbSURBVBhXY3growJHIM5/GIBy0GWgHCiSUQEAe00iZYBvZ5oAAAAASUVORK5CYII=",e.login={},e.signup={},e.opciones="mostrar";var A="Restauracion_de_PIN_GAMLP",u="Usted_solicito_restaurar_PIN.";e.datos="",e._id="",e.getCaptchasX=function(){$.blockUI(),e.valorrandom=Math.floor(223*Math.random()+1),e.resultadoC="";var o=new reglasnegocio;o.identificador="RCCIUDADANO_77",o.parametros='{"x":"'+e.valorrandom+'"}',o.llamarregla(function(o){o=JSON.parse(o),$.unblockUI(),e.data_capX=o,e.idImg=o[0].vctcs_id,e.Imgenf=o[0].vctcs_url,e.imageCST=o[0].vctcs_urlc,"A"==o[0].vlng&&(e.lengua="AYMARA"),"Q"==o[0].vlng&&(e.lengua="QUECHUA"),"G"==o[0].vlng&&(e.lengua="GUARANI"),"C"==o[0].vlng&&(e.lengua="CASTELLANO"),e.imageLNG=e.Imgenf,e.palabraT="Ingrese texto: "+e.lengua+" CASTELLANO",e.toltipT="Palabra en "+e.lengua})},e.VerificarCapcha=function(o,a){var t=new reglasnegocio;t.identificador="RCCIUDADANO_88",t.parametros='{"id":"'+e.idImg+'","rsp":"'+e.resultadoC+'"}',t.llamarregla(function(t){t=JSON.parse(t),$.unblockUI(),e.data_capXres=t,0==e.data_capXres.length?(e.getCaptchasX(),e.resultadoC="",d.show("Advertencia","Vuelva registrar el capcha","error")):e.restaurarPin2(o,a)})},e.inicioLoginNode=function(){alert("inicio login")},e.validarInicioLogin=function(){if(document.getElementById("dvContenidoView").style.display="block",document.getElementById("dvContenidoVacio").style.display="none",sessionStorage.getItem("autenticacion")){var o=sessionStorage.getItem("autenticacion");try{var a=JSON.parse(o);a.length>0?e.doLoginNode(o):window.location.href="../autenticacion/partials/login_.html"}catch(e){window.location.href="../autenticacion/partials/login_.html"}}e.$apply()},e.$on("api:ready",function(){if(document.getElementById("dvContenidoView").style.display="block",document.getElementById("dvContenidoVacio").style.display="none",sessionStorage.getItem("autenticacion")){var o=sessionStorage.getItem("autenticacion");try{var a=JSON.parse(o);a.length>0?e.doLoginNode(o):window.location.href="../autenticacion/partials/login_.html"}catch(e){window.location.href="../autenticacion/partials/login_.html"}}}),e.sesionToken=function(){var e=r.CONEXION_MOTOR_SERVICIO+"motorservicio_pruebas/public/api/apiLogin";$.ajax({dataType:"json",type:"POST",url:e,data:{usr_usuario:"administrador",usr_clave:"123456"},async:!1,success:function(e){dataResp=JSON.stringify(e),sessionStorage.setItem("TOKEN_MOTOR",e.token)},error:function(e,o,a){dataResp='{"error":{"message":"'+e.responseText+'","code":700}}',console.log(dataResp)}})},e.doLoginNode=function(a){if(!o.idioma){var n=new rcIdioma;o.idioma=i.get("Idioma"),n.filtro=o.idioma,n.obtenerTitulos(function(a){e.Label=JSON.parse(a),o.translateTitulos={},angular.forEach(e.Label.success,function(e,a){o.translateTitulos[e.idm_label]=e.idm_contenido})}),n.obtenerContenidos(function(a){e.Contenidos=JSON.parse(a),o.translateContenidos={},angular.forEach(e.Contenidos.success,function(e,a){o.translateContenidos[e.idm_label]=e.idm_contenido})}),n.obtenerImagenes(function(a){e.Imagenes=JSON.parse(a),o.translateImagenes={},angular.forEach(e.Imagenes.success,function(e,a){o.translateImagenes[e.idm_label]=e.idm_contenido})}),n.obtenerMensajes(function(a){e.Mensajes=JSON.parse(a),o.translateMensajes={},angular.forEach(e.Mensajes.success,function(e,a){o.translateMensajes[e.idm_label]=e.idm_contenido})});var s=JSON.parse(a),r=s[0].dtspsl_tipo_persona;if(e.sesionToken(),s.length>0&&"NATURAL"==r){var l=s[0].dtspsl_activaciond,A=s[0].dtspsl_activacionf;if(i.set("IDCIUDADANO",s[0]._id),i.set("CICIUDADANO",s[0].dtspsl_ci),localStorage.setItem("CI",s[0].dtspsl_ci),i.set("IDUSUARIO",s[0]._id),i.set("IDSOLICITANTE",s[0]._id),i.set("USUARIO","Ciudadano"),(s[0].dtspsl_tipo_persona="NATURAL")?(i.set("US_NOMBRE",s[0].dtspsl_nombres),i.set("US_PATERNO",s[0].dtspsl_paterno),i.set("US_MATERNO",s[0].dtspsl_materno),i.set("US_EMAIL",s[0].dtspsl_correo)):(i.set("US_NOMBRE",s[0].dtspsl_razon_social),i.set("US_PATERNO",s[0].dtspsl_paterno),i.set("US_MATERNO",s[0].dtspsl_materno),i.set("US_EMAIL",s[0].dtspsl_correo)),o.nombre=i.get("USUARIO"),i.set("TIPO_PERSONA",s[0].dtspsl_tipo_persona),o.vid=s[0]._id,"SI"==l&&"SI"==A){i.set("US_IDROL","5"),i.set("US_ROL","Ciudadano nivel 2"),$.unblockUI(),c.almacenarLog(4,s[0]._id,0,"Inicio de session NIVEL 2");var u=sessionStorage.getItem("urliniciomoduloigob");u=decodeURIComponent(u),u&&"null"!=u?(sessionStorage.removeItem("urliniciomoduloigob"),t.path(u)):t.path("dashboard")}else if("NO"==l&&"NO"==A){i.set("US_IDROL","4"),i.set("US_ROL","Ciudadano nivel 1"),$.unblockUI(),c.almacenarLog(4,s[0]._id,0,"Inicio de session NIVEL 1");var u=sessionStorage.getItem("urliniciomoduloigob");u&&"null"!=u?(sessionStorage.removeItem("urliniciomoduloigob"),t.path(u)):t.path("dashboard")}}else if(s.length>0&&"JURIDICO"==r){if(s.length>0){var l=s[0].dtspsl_activaciond,A=s[0].dtspsl_activacionf;if(i.set("IDCIUDADANO",s[0]._id),i.set("CICIUDADANO",s[0].dtspsl_ci),i.set("NITCIUDADANO",s[0].dtspsl_nit),i.set("IDUSUARIO",s[0]._id),i.set("IDSOLICITANTE",s[0]._id),i.set("USUARIO","Empresa"),i.set("US_ROL","Empresa"),o.nombre=i.get("USUARIO"),i.set("US_NOMBRE",s[0].dtspsl_razon_social),i.set("US_PATERNO",s[0].dtspsl_paterno_representante),i.set("US_MATERNO",s[0].dtspsl_materno),i.set("US_EMAIL",s[0].dtspsl_correo),o.vid=s[0]._id,i.set("TIPO_PERSONA",s[0].dtspsl_tipo_persona),"SI"==l&&"SI"==A)i.set("US_IDROL","5"),i.set("US_ROL","Empresa nivel 2"),$.unblockUI(),c.almacenarLog(4,s[0]._id,0,"Inicio de session NIVEL 2"),t.path("dashboard");else if("NO"==l&&"NO"==A)i.set("US_IDROL","4"),i.set("US_ROL","Empresa nivel 1"),$.unblockUI(),c.almacenarLog(4,s[0]._id,0,"Inicio de session NIVEL 1"),t.path("dashboard");else{$.unblockUI();var I="por primera y única vez,";d.show("","Estimado usuario. Active su cuenta aproximándose "+I+" a la plataforma más cercana, donde validarán sus datos y activarán su cuenta. Otorgándole acceso a los servicios en línea del GAMLP.","error")}}}else window.location.href="../autenticacion/partials/login_.html"}},e.logout=function(){document.getElementById("dvContenidoView").style.display="none",c.almacenarLog(4,i.get("IDUSUARIO"),0,"Cierre de sesión"),i.destroy("USER"),i.destroy("IDUSUARIO"),i.destroy("USUARIO"),i.destroy("US_IDROL"),i.destroy("US_ROL"),i.destroy("US_NOMBRE"),i.destroy("US_PATERNO"),i.destroy("US_MATERNO"),i.destroy("IDCIUDADANO"),i.destroy("CICIUDADANO"),i.destroy("NITCIUDADANO"),i.destroy("IDSOLICITANTE"),i.destroy("US_EMAIL"),document.getElementById("menuIzqui").style.display="none",document.getElementById("menuIzqui2").style.display="none",sessionStorage.removeItem("autenticacion"),window.location.href="../autenticacion/partials/login_.html"},e.registroCiudadano=function(e){},e.verServicios=function(){e.opciones=null,e.servicios="visible"},e.verParticipacion=function(){e.opciones=null,e.servicios=null,e.participacionCiudadana="visible"},e.volverOpciones=function(){e.servicios=null,e.opciones="visible"},e.volverParticipacion=function(){e.participacionCiudadana=null,e.opciones="visible"},e.envioMensaje=function(e,o,a,t){var n=e.replace(/ /g,"_"),s={cuerpo:n,asunto:A,para:t,ciudadano:a,mensaje:u};$.ajax({data:s,url:"http://gmlpsr0179:9090/smsemail/email/mail.php",type:"get",beforeSend:function(){},success:function(e){}}),d.show("",o,"success")},e.restaurarPin2=function(e,o){sNumeroAleatorio=Math.round(1e5*Math.random())+e;var a="";a="dtspsl_ci='"+e+"' and dtspsl_correo='"+o+"'";$.blockUI(),$.unblockUI(),document.getElementById("prsCI").value="",document.getElementById("prsCorreo").value=""},e.inicioCapcha=function(){e.getCaptchasX()}});