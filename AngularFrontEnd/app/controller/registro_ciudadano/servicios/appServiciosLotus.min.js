app.controller("serviciosLotusController",function(_,o,e,a,i,t,s,p,n,c,d,f,l,I,m,u,A,T,C){_.imageCST="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAAFCAIAAADtz9qMAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAbSURBVBhXY3growJHIM5/GIBy0GWgHCiSUQEAe00iZYBvZ5oAAAAASUVORK5CYII=",_.imageLNG="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAAFCAIAAADtz9qMAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAbSURBVBhXY3growJHIM5/GIBy0GWgHCiSUQEAe00iZYBvZ5oAAAAASUVORK5CYII=",_.tablaTramites={},_.tramitesUsuario=[],_.formRegularRegistrado="",_.datosinic={},_.btover_c=!1,_.templates=[{name:"template0.html",url:"../../../app/index.html"},{name:"template1.html",url:"../../../app/view/servicios/varios/formularios/solicitudLotus/moustache/moustache.html"}],_.serviciosLotus=[{name:"Correspondencia ciudadana",id:"15",idprc:"185",idcampo:"2025",scodigo:"CORC"},{name:"Ejecución de procesos de fiscalización",id:"16",idprc:"185",idcampo:"2026",scodigo:"EPFZ"},{name:"Denuncias y reclamos",id:"17",idprc:"185",idcampo:"2027",scodigo:"DRTR"},{name:"Calificación de años de servicio",id:"18",idprc:"185",idcampo:"2028",scodigo:"CAS"},{name:"Fotocopias",id:"19",idprc:"185",idcampo:"2029",scodigo:"FOT"},{name:"Publicidad urbana",id:"20",idprc:"185",idcampo:"2030",scodigo:"PUB"},{name:"Catastro",id:"21",idprc:"185",idcampo:"2031",scodigo:"CAT"},{name:"Inmuebles",id:"22",idprc:"185",idcampo:"2033",scodigo:"INM"},{name:"Administración territorial",id:"23",idprc:"185",idcampo:"2034",scodigo:"ADMT"},{name:"Fiscalización tributos municipales",id:"24",idprc:"185",idcampo:"2035",scodigo:"FTM"},{name:"Vehículos",id:"25",idprc:"185",idcampo:"2036",scodigo:"VEH"},{name:"Planilla pago de obras",id:"26",idprc:"185",idcampo:"2037",scodigo:"PPO"},{name:"Correspondencia Ciudadana cm (cccm)",id:"27",idprc:"185",idcampo:"2038",scodigo:"CCCM"},{name:"Comercio en vías y espacios públicos",id:"28",idprc:"185",idcampo:"2155",scodigo:"CVEP"},{name:"Mercados municipales de abasto",id:"29",idprc:"185",idcampo:"2156",scodigo:"MMA"},{name:"Transferencia de área residual",id:"30",idprc:"185",idcampo:"2158",scodigo:"TAR"},{name:"Uso de espacios públicos temporales",id:"31",idprc:"185",idcampo:"2169",scodigo:"UEPP"}],_.btnEnviarForm=!0,_.habGuardar1=!0,_.template="";new Array;_.recuperarDatosRegistro=function(){$.blockUI();var e={},a=new rcNatural;a.oid=s.get("IDSOLICITANTE"),a.datosCiudadanoNatural(function(o){if(results=JSON.parse(o),results[0].dtspsl_file_fotocopia_ci&&(_.btover=!0),results[0].dtspsl_file_fotocopia_ci_r&&(_.btover1=!0),"NATURAL"==results[0].dtspsl_tipo_persona){results[0].dtspsl_file_fotocopia_ci;e.FILE_FOTOCOPIA_CI=results[0].dtspsl_file_fotocopia_ci,e.FILE_FOTOCOPIA_CI_R=results[0].dtspsl_file_fotocopia_ci_r,e.FILE_FACTURA_LUZ=results[0].dtspsl_file_factura_luz}else"JURIDICO"==results[0].dtspsl_tipo_persona&&(e.FILE_FOTOCOPIA_CI=results[0].dtspsl_file_fotocopia_ci,e.FILE_FOTOCOPIA_CI_R=results[0].dtspsl_file_fotocopia_ci_r,$.unblockUI())}),_.datosinic=e,o.archivoCI=p.APIURL+"/files/RC_CLI/"+s.get("IDSOLICITANTE")+"/"+_.datosinic.FILE_FOTOCOPIA_CI+"?app_name=todoangular",o.archivoCIR=p.APIURL+"/files/RC_CLI/"+s.get("IDSOLICITANTE")+"/"+_.datosinic.FILE_FOTOCOPIA_CI_R+"?app_name=todoangular",o.archivoLuz=p.APIURL+"/files/RC_CLI/"+s.get("IDSOLICITANTE")+"/"+_.datosinic.FILE_FACTURA_LUZ+"?app_name=todoangular",$.unblockUI()},_.recuperandoDatosInicialesCiudadano=function(){var o=s.get("IDUSUARIO");_.habGuardar1=!0,_.datosIniciales="";var e=new rcNatural;e.oid=o,e.datosCiudadanoNatural(function(o){resultadoApi=JSON.parse(o),datos=resultadoApi[0],_.datosIniciales=resultadoApi[0]})},_.tramitesCiudadano=function(o){sIdCiudadano=s.get("IDSOLICITANTE");try{var e=new rcTramites;e.oid=sIdCiudadano,e.obtTramitesx(function(e){r=JSON.parse(e),results=r.success,angular.forEach(results,function(_,o){_.form_contenido&&(results[o].datos=JSON.parse(_.form_contenido))}),_.tramitesUsuario=results;results;_.tablaTramites.reload(),o&&_.seleccionarTramite(o)})}catch(_){console.log("Error Interno : ",_)}},_.tablaTramites=new f({page:1,count:4,filter:{},sorting:{vtra_id:"desc"}},{total:_.tramitesUsuario.length,getData:function(o,e){var a=e.filter()?l("filter")(_.tramitesUsuario,e.filter()):_.tramitesUsuario,r=e.sorting()?l("orderBy")(a,e.orderBy()):_.tramitesUsuario;e.total(_.tramitesUsuario.length),o.resolve(r.slice((e.page()-1)*e.count(),e.page()*e.count()))}}),_.iniciandoDatos=function(){var e=_.datosIniciales,a=T.obtenerFechaActual();_.datos={};var r={};r.CI_BIGDATA=e.CI_BIGDATA,r.INT_FEC_SOLICITUD=a,r.f01_nom_completo=e.f01_nom_completo,r.f01_tip_doc_prop=e.f01_tip_doc_prop,r.f01_num_dos_prop=e.f01_num_dos_prop,r.f01_expedido_prop=e.f01_expedido_prop,r.f01_email_prop=e.f01_email_prop,r.f01_cel_prop=e.f01_cel_prop,r.f01_telef_prop=e.f01_telef_prop,r.f01_fecha_nac=e.f01_fecha_nac,r.f01_ape_mat_prop=e.f01_ape_mat_prop,r.f01_ape_pat_prop=e.f01_ape_pat_prop,r.f01_pri_nom_prop=e.f01_pri_nom_prop,r.f01_tel_ciudadano=e.f01_tel,r.f01_piso_prop=e.f01_piso_prop,r.f01_depa_prop=e.f01_depa_prop,r.f01_rl_nit=e.f01_rl_nit,r.f01_rl_razon_zocial=e.f01_rl_razon_zocial,r.INT_RL_TIPO_DOCUMENTO="",r.f01_rl_num_documento="",r.f01_tipo_per=e.f01_tipo_per,r.f01_pri_nom_prop=e.f01_pri_nom_prop,r.f01_ape_pat_prop=e.f01_ape_pat_prop,r.f01_ape_mat_prop=e.f01_ape_mat_prop,r.f01_ape_cas_prop=e.f01_ape_cas_prop,r.f01_macro=e.f01_macro,r.f01_macro_des=e.f01_macro_des,r.f01_distrito=e.f01_distrito,r.f01_distrito_desc=e.f01_distrito_desc,r.f01_zona=e.f01_zona,r.f01_zon_prop_valor=e.f01_zon_prop_valor,r.INT_VIA=e.INT_VIA,r.f01_nom_via_prop=e.f01_nom_via_prop,r.f01_num_prop=e.f01_num_prop,r.INT_EDIF=e.INT_EDIF,r.f01_bloq_prop=e.f01_bloq_prop,r.INT_PISO=e.INT_PISO,r.INT_NUM_DEP=e.INT_NUM_DEP,r.INT_DIR_DET=e.INT_DIR_DET,r.INT_RL_FEC_EMISION_DOCUMENTO=e.INT_RL_FEC_EMISION_DOCUMENTO,r.INT_NACIONALIDAD=e.INT_NACIONALIDAD,r.INT_RL_FEC_NACIMIENTO=e.INT_RL_FEC_NACIMIENTO,r.INT_NIT=e.INT_NIT,r.f01_tip_via_prop=e.f01_tip_via_prop,r.INT_RL_TIPO_DOCUMENTO=e.INT_RL_TIPO_DOCUMENTO,r.f01_rl_num_documento=e.f01_rl_num_documento,r.INT_RL_FECHA_NAC=e.INT_RL_FECHA_NAC,r.IDTRAMITE=e.IDTRAMITE,r.f01_num_doc_rep=e.f01_num_doc_rep,r.f01_num_notaria=e.f01_num_notaria,r.f01_num_rep=e.f01_num_rep,r.f01_tip_doc_rep="NIT",r.f01_num_doc_per_jur=e.f01_num_doc_per_jur,r.f01_raz_soc_per_jur=e.f01_raz_soc_per_jur,r.f01_tip_doc_rep=e.f01_tip_doc_rep,r.f01_expedido_rep=e.f01_expedido_rep,r.f01_pri_nom_rep=e.f01_pri_nom_rep,r.f01_seg_nom_rep=e.f01_seg_nom_rep,r.f01_ter_nom_rep=e.f01_ter_nom_rep,r.f01_ape_pat_rep=e.f01_ape_pat_rep,r.f01_ape_mat_rep=e.f01_ape_mat_rep,r.f01_ape_cas_rep=e.f01_ape_cas_rep,r.f01_ges_vig_pod=e.f01_ges_vig_pod,r.f01_num_doc_rep=e.f01_num_doc_rep,r.f01_num_pod_leg=e.f01_num_pod_leg,r.f01_tip_doc_rep=e.f01_tip_doc_rep,r.f01_email_rep=e.f01_email_rep,r.f01_cel_rep=e.f01_cel_rep,r.f01_telef_rep=e.f01_telef_rep,r.INT_FEC_SOLICITUD=a,r.f01_fecha_nac=e.f01_fecha_nac,r.TIPO="AE_INT_EMISION",r.f01_raz_soc=e.f01_raz_soc,r.INT_RL_TIPO_DOCUMENTO="NIT",r.f01_num_rep=e.f01_num_rep,r.f01_nom_via_rep=e.f01_nom_via_rep,r.f01_tipo_viarep=e.f01_tipo_viarep,r.f01_id_zona_rep=e.f01_id_zona_rep,r.f01_zona_rep=e.f01_zona_rep,r.f01_zon_rep_valor=e.f01_zon_rep_valor,r.INT_NIT=e.INT_NIT,r.f01_poder_representante=e.f01_poder_representante,r.f01_test_cons_sociedad_j=e.f01_test_cons_sociedad_j,r.file_num_ident=e.file_num_ident,r.file_reg_comer=e.file_reg_comer,r.file_fund_emp=e.file_fund_emp,r.INT_AC_TIP_VIA=e.INT_AC_TIP_VIA,"N"==e.f01_tipo_per||"NATURAL"==e.f01_tipo_per?(r.FILE_FOTOCOPIA_CI=_.datosinic.FILE_FOTOCOPIA_CI,r.FILE_FOTOCOPIA_CI_R=_.datosinic.FILE_FOTOCOPIA_CI_R,r.FILE_FACTURA_LUZ=_.datosinic.FILE_FACTURA_LUZ):"J"!=e.f01_tipo_per&&"JURIDICO"!=e.f01_tipo_per||(_.btover_c=!0,r.id_representante=e.id_representante,r.FILE_FOTOCOPIA_CI=e.FILE_FOTOCOPIA_CI_RA,r.FILE_FOTOCOPIA_CI_R=e.FILE_FOTOCOPIA_CI_RR,r.f01_poder_representante=e.f01_poder_representante,r.f01_test_cons_sociedad_j=e.f01_test_cons_sociedad_j,r.file_num_ident=e.file_num_ident,r.file_reg_comer=e.file_reg_comer,r.file_fund_emp=e.file_fund_emp),r.IDTRAMITE=_.sIdTramiteSeleccionado,o.looo=0,o.laaa=0,_.datos=r,"N"!=e.f01_tipo_per&&"NATURAL"!=e.f01_tipo_per||(e.f01_macro&&e.f01_distrito&&e.f01_distrito_desc&&e.f01_zona&&e.f01_zon_prop_valor&&e.f01_tip_via_prop&&e.f01_nom_via_prop&&e.f01_num_prop?_.validacionDireccion=!1:(_.validacionDireccion=!0,d.show("Complete información","Datos de dirección son obligatorios debe completar la información de su cuenta","error")))},_.recuperarFormsxProceso=function(o){jDataFormsLotus=[];var e=185,a=o.datos.INT_ID_FORM_LOTUS,r=new getFormulario;r.idprc=e,r.idcampo=a,r.obtForms(function(e){var a=JSON.parse(e).success.data[0].exportar_formulario;jDataFormsLotus=a,_.tramiteSeleccionado=o.idcampo,_.formtramite=o})},_.seleccionarProcesoT=function(o){_.formtramite=o,_.tramiteSeleccionado=o.idcampo},_.seleccionarTramite=function(o){_.template="",$.blockUI(),_.recuperarFormsxProceso(o),setTimeout(function(){_.seleccionarTramiteRender(o),_.$apply(),$.unblockUI()},500)},_.seleccionarTramiteRender=function(e){o.tramiteId=e.vtra_id,s.set("IDTRAMITE",e.vtra_id),s.set("IDSERVICIO",e.vdvser_id),s.set("ESTADO",e.venviado),s.set("tramiteIgob",JSON.stringify(e.datos)),_.template="",_.formulario="mostrar";s.get("TIPO_PERSONA"),e.vdvser_id;_.template=_.templates[1],_.recuperarSerializarInfo(e),_.tramiteSeleccionado=e.vtra_id;var a=document.getElementById("tipo_contribuyente");a&&(a.style.display="none")};new Array;_.recuperarSerializarInfo=function(o){var e=o.vtra_id,a=s.get("IDSOLICITANTE"),r=s.get("IDSERVICIO"),i=null;_.btover_c=!0,_.sIdTramiteSeleccionado=o.vtra_id,i=new datosFormularios,i.frm_tra_id_ciudadano=a,i.frm_tra_dvser_id=r,i.frm_idTramite=e,i.splistafrmdatos(function(o){results=JSON.parse(o).success[0].form_contenido,svalorJosn=[],Object.keys(JSON.parse(results)).length>5?(datos=[],svalorJosn=JSON.parse(results)):(datos=_.datosIniciales,datos.DATA_FORM=JSON.parse(results)),dataFinal=_.datos})},_.clsRegistrarNuevo=function(){_.formtramite={}},_.adicionarServicioGamlp=function(o){_.template="";var e={},a={},r=new Date,i=r.getFullYear()+"-"+(r.getMonth()+1)+"-"+r.getDate()+" "+r.getHours()+":"+r.getMinutes()+":"+r.getSeconds(),t=o.id,p=s.get("IDSOLICITANTE"),n=i;e.INT_FORM_ALMACENADO="C",e.INT_ID_FORM_LOTUS=o.idcampo,e.POC_TIPO_TRAMITE=o.scodigo,a.vdvser_id=o.id,a.venviado="NO",a.datos=e,a.form_contenido=JSON.stringify(e);var c=JSON.stringify(e);$.blockUI();try{var d=new adicionaTramitesFormulario;d.frm_tra_fecha=n,d.frm_tra_enviado="NO",d.frm_tra_registrado=i,d.frm_tra_modificado=i,d.id_servicio=t,d.data_json=c,d.oid_ciudadano=p,d.id_usuario=3,$.blockUI(),d.adiciona_Tramites_Formulario(function(o){x=JSON.parse(o),response=x.success,response.length>0?(s.set("IDTRAMITE : ",response[0].sp_insertar_formulario_tramites_datos),$.unblockUI(),a.vtra_id=response[0].sp_insertar_formulario_tramites_datos,_.tramitesCiudadano(a),_.getCaptchasX(),alertify.success("Formulario creado correctamente .."),s.destroy("NROTRAMITE"),s.destroy("NROTRAMITEID"),s.destroy("IDPROCESO"),_.btnEnviarForm=!1,_.btnGuardarForm=!1,$("#registro").modal("hide")):$.unblockUI()})}catch(_){console.log("*Error*"),$.unblockUI()}},_.almacenarRequisitos=function(o,e){_.oidCiudadano=s.get("IDSOLICITANTE");var a=s.get("IDTRAMITE");_.direccionvirtual="RC_CLI/"+_.oidCiudadano;var r=p.APIURL+"/files/"+_.direccionvirtual+"/"+a+"/";angular.forEach(o,function(o,i){"undefined"!=typeof o&&(url=p.APIURL+"/files/"+_.direccionvirtual+"/"+a+"/"+o.name+"?app_name=todoangular",document.getElementById("href_f01_upload_"+e).href=url,document.getElementById(e).value=url,A.uploadFileToUrl(o,r))})},_.$on("api:ready",function(){_.recuperandoDatosInicialesCiudadano(),_.tramitesCiudadano()}),_.inicioServicios=function(){_.recuperandoDatosInicialesCiudadano(),_.tramitesCiudadano()}});