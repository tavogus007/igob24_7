function SOAPClientParameters(){var e=new Array;this.add=function(t,n){return e[t]=n,this},this.toXml=function(){var t="";for(var n in e)switch(typeof e[n]){case"string":case"number":case"boolean":case"object":t+="<"+n+">"+SOAPClientParameters._serialize(e[n])+"</"+n+">"}return t}}function SOAPClient(){}SOAPClientParameters._serialize=function(e){var t="";switch(typeof e){case"string":t+=e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");break;case"number":case"boolean":t+=e.toString();break;case"object":if(e.constructor.toString().indexOf("function Date()")>-1){var n=e.getFullYear().toString(),r=(e.getMonth()+1).toString();r=1==r.length?"0"+r:r;var a=e.getDate().toString();a=1==a.length?"0"+a:a;var o=e.getHours().toString();o=1==o.length?"0"+o:o;var l=e.getMinutes().toString();l=1==l.length?"0"+l:l;var s=e.getSeconds().toString();s=1==s.length?"0"+s:s;for(var i=e.getMilliseconds().toString(),u=Math.abs(e.getTimezoneOffset()),d=0;u>=60;)d++,u-=60;u=1==u.toString().length?"0"+u.toString():u.toString(),d=1==d.toString().length?"0"+d.toString():d.toString();var c=(e.getTimezoneOffset()<0?"+":"-")+d+":"+u;t+=n+"-"+r+"-"+a+"T"+o+":"+l+":"+s+"."+i+c}else if(e.constructor.toString().indexOf("function Array()")>-1)for(var g in e)if(isNaN(g))t+="<"+g+">"+SOAPClientParameters._serialize(e[g])+"</"+g+">";else{/function\s+(\w*)\s*\(/gi.exec(e[g].constructor.toString());var S=RegExp.$1;switch(S){case"":S=typeof e[g];case"String":S="string";break;case"Number":S="int";break;case"Boolean":S="bool";break;case"Date":S="DateTime"}t+="<"+S+">"+SOAPClientParameters._serialize(e[g])+"</"+S+">"}else for(var g in e)t+="<"+g+">"+SOAPClientParameters._serialize(e[g])+"</"+g+">"}return t},SOAPClient.username=null,SOAPClient.password=null,SOAPClient.invoke=function(e,t,n,r,a){return r?void SOAPClient._loadWsdl(e,t,n,r,a):SOAPClient._loadWsdl(e,t,n,r,a)},SOAPClient_cacheWsdl=new Array,SOAPClient._loadWsdl=function(e,t,n,r,a){var o=SOAPClient_cacheWsdl[e];if(o+""!=""&&o+""!="undefined")return SOAPClient._sendSoapRequest(e,t,n,r,a,o);var l=SOAPClient._getXmlHttp();return l.open("GET",e+"?wsdl",r),r&&(l.onreadystatechange=function(){4==l.readyState&&SOAPClient._onLoadWsdl(e,t,n,r,a,l)}),l.send(null),r?void 0:SOAPClient._onLoadWsdl(e,t,n,r,a,l)},SOAPClient._onLoadWsdl=function(e,t,n,r,a,o){var l=o.responseXML;return SOAPClient_cacheWsdl[e]=l,SOAPClient._sendSoapRequest(e,t,n,r,a,l)},SOAPClient._sendSoapRequest=function(e,t,n,r,a,o){var l=o.documentElement.attributes.targetNamespace+""=="undefined"?o.documentElement.attributes.getNamedItem("targetNamespace").nodeValue:o.documentElement.attributes.targetNamespace.value,s='<?xml version="1.0" encoding="utf-8"?><soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"><soap:Body><'+t+' xmlns="'+l+'">'+n.toXml()+"</"+t+"></soap:Body></soap:Envelope>",i=SOAPClient._getXmlHttp();SOAPClient.userName&&SOAPClient.password?(i.open("POST",e,r,SOAPClient.userName,SOAPClient.password),i.setRequestHeader("Authorization","Basic "+SOAPClient._toBase64(SOAPClient.userName+":"+SOAPClient.password))):i.open("POST",e,r);var u=(l.lastIndexOf("/")!=l.length-1?l+"/":l)+encodeURIComponent(t);if(i.setRequestHeader("SOAPAction",u),i.setRequestHeader("Content-Type","text/xml; charset=utf-8"),r&&(i.onreadystatechange=function(){4==i.readyState&&SOAPClient._onSendSoapRequest(t,r,a,o,i)}),i.send(s),!r)return SOAPClient._onSendSoapRequest(t,r,a,o,i)},SOAPClient._onSendSoapRequest=function(e,t,n,r,a){var o=null,l=SOAPClient._getElementsByTagName(a.responseXML,e+"Result");if(0==l.length&&(l=SOAPClient._getElementsByTagName(a.responseXML,"return")),0==l.length){if(a.responseXML.getElementsByTagName("faultcode").length>0){if(!t&&!n)throw new Error(500,a.responseXML.getElementsByTagName("faultstring")[0].childNodes[0].nodeValue);o=new Error(500,a.responseXML.getElementsByTagName("faultstring")[0].childNodes[0].nodeValue)}}else o=SOAPClient._soapresult2object(l[0],r);if(n&&n(o,a.responseXML),!t)return o},SOAPClient._soapresult2object=function(e,t){var n=SOAPClient._getTypesFromWsdl(t);return SOAPClient._node2object(e,n)},SOAPClient._node2object=function(e,t){if(null==e)return null;if(3==e.nodeType||4==e.nodeType)return SOAPClient._extractValue(e,t);if(1==e.childNodes.length&&(3==e.childNodes[0].nodeType||4==e.childNodes[0].nodeType))return SOAPClient._node2object(e.childNodes[0],t);var n=SOAPClient._getTypeFromWsdl(e.nodeName,t).toLowerCase().indexOf("arrayof")!=-1;if(n){for(var r=new Array,a=0;a<e.childNodes.length;a++)r[r.length]=SOAPClient._node2object(e.childNodes[a],t);return r}var o=null;e.hasChildNodes()&&(o=new Object);for(var a=0;a<e.childNodes.length;a++){var l=SOAPClient._node2object(e.childNodes[a],t);o[e.childNodes[a].nodeName]=l}return o},SOAPClient._extractValue=function(e,t){var n=e.nodeValue;switch(SOAPClient._getTypeFromWsdl(e.parentNode.nodeName,t).toLowerCase()){default:case"s:string":return null!=n?n+"":"";case"s:boolean":return n+""=="true";case"s:int":case"s:long":return null!=n?parseInt(n+"",10):0;case"s:double":return null!=n?parseFloat(n+""):0;case"s:datetime":if(null==n)return null;n+="",n=n.substring(0,n.lastIndexOf(".")==-1?n.length:n.lastIndexOf(".")),n=n.replace(/T/gi," "),n=n.replace(/-/gi,"/");var r=new Date;return r.setTime(Date.parse(n)),r}},SOAPClient._getTypesFromWsdl=function(e){var t=new Array,n=e.getElementsByTagName("s:element"),r=!0;0==n.length&&(n=e.getElementsByTagName("element"),r=!1);for(var a=0;a<n.length;a++)r?null!=n[a].attributes.getNamedItem("name")&&null!=n[a].attributes.getNamedItem("type")&&(t[n[a].attributes.getNamedItem("name").nodeValue]=n[a].attributes.getNamedItem("type").nodeValue):null!=n[a].attributes.name&&null!=n[a].attributes.type&&(t[n[a].attributes.name.value]=n[a].attributes.type.value);return t},SOAPClient._getTypeFromWsdl=function(e,t){var n=t[e]+"";return"undefined"==n?"":n},SOAPClient._getElementsByTagName=function(e,t){try{return e.selectNodes('.//*[local-name()="'+t+'"]')}catch(e){}return e.getElementsByTagName(t)},SOAPClient._getXmlHttp=function(){try{if(window.XMLHttpRequest){var e=new XMLHttpRequest;return null==e.readyState&&(e.readyState=1,e.addEventListener("load",function(){e.readyState=4,"function"==typeof e.onreadystatechange&&e.onreadystatechange()},!1)),e}if(window.ActiveXObject)return new ActiveXObject(SOAPClient._getXmlHttpProgID())}catch(e){}throw new Error("Your browser does not support XmlHttp objects")},SOAPClient._getXmlHttpProgID=function(){if(SOAPClient._getXmlHttpProgID.progid)return SOAPClient._getXmlHttpProgID.progid;for(var e,t=["Msxml2.XMLHTTP.5.0","Msxml2.XMLHTTP.4.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],n=0;n<t.length;n++)try{return e=new ActiveXObject(t[n]),SOAPClient._getXmlHttpProgID.progid=t[n]}catch(e){}throw new Error("Could not find an installed XML parser")},SOAPClient._toBase64=function(e){var t,n,r,a,o,l,s,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",u="",d=0;do t=e.charCodeAt(d++),n=e.charCodeAt(d++),r=e.charCodeAt(d++),a=t>>2,o=(3&t)<<4|n>>4,l=(15&n)<<2|r>>6,s=63&r,isNaN(n)?l=s=64:isNaN(r)&&(s=64),u=u+i.charAt(a)+i.charAt(o)+i.charAt(l)+i.charAt(s);while(d<e.length);return u};