function Padleft(o,e){var a=""+e;return ans=o.substring(0,o.length-a.length)+a}function DuplicadosController(o,e,a,r,t,i,s,n,d,c,l,u,p,g,m,f,v,I,D,C,S){function O(o){var o=window.event||o;Math.max(-1,Math.min(1,o.wheelDelta||-o.detail));return!1}o.tablaSolicitudes={},o.solicitudesUsuario=[],o.RegistroFUM={registrado:null,mensaje:null},o.srcTutorial="../catastro/img/Infografia.png",o.cambiarImagen=function(e){0==e?o.srcTutorial="../catastro/img/Infografia.png":o.srcTutorial="../catastro/img/paso"+e+".png",o.idNav=e},o.navegarGuiaTramite=function(){switch(o.idNav){case 1:$("#divPopup").modal("show");break;case 2:$("#divPopup7").modal("show");break;case 3:$("#divPopup9").modal("show");break;case 4:$("#divPopupTipoPago").modal("show");break;case 5:$("#divPopup4").modal("show");break;case 6:$("#divPopup7").modal("show");break;case 7:$("#divPopup8").modal("show")}},o.ConfIntegra={idServicio:8,idProcodigo:"AE-RAJ",idTramite:0},o.varSpin=!1;var E={cedula:"",complemento:"",celular:"",correo:"",direccion:"",estado_civil:"",fecha_nacimiento:"",materno:"",nombre:"",ocupacion:"",paterno:"",sexo:"",telefono:"",cedula2:"",nit2:"",complemento2:"",repLegal:"",nroDocumento:"",nroNotaria:"",nit:"",razonSocial:"",tipoP:"",cestcivil_id:"",expedido:""};monthNames=["ENERO","FEBRERO","MARZO","ABRIL","MAYO","JUNIO","JULIO","AGOSTO","SEPTIEMBRE","OCTUBRE","NOVIEMBRE","DICIEMBRE"],o.diasImpresion=60,o.inicioSolicitudes=function(){o.loginPagoEnLinea(),o.recuperarDatosRegistro(),o.CargarComboMotivos(),o.CargarComboMotivosDetalle(),o.lstCC(),o.registro3=E,o.solicitudesCiudadano()},o.loginPagoEnLinea=function(){var o={usr_usuario:"tecnico",usr_clave:"123456"};$.ajax({dataType:"json",type:"POST",url:"https://pagonline.lapaz.bo/api/logueo",data:o,async:!1,success:function(o){s.set("TOKEN",o.token)},error:function(o,e,a){dataResp='{"error":{"message":"'+o.responseText+'","code":700}}',console.log("Error login pago en linea",o)}})},o.gDpl=function(e){var a={q:e.f};t({method:"POST",url:n.SERVICE_SITOLext+"gdpl",data:Object.toparams(a),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(e,a,r,t){"OK"==e.res&&o.lstSolUnico()}).error(function(o,e,a,r){l.show("","Error al gen dpl","error"),console.log("Error gDpl",o)})},o.vdplepago=function(e){var a=e.FUM,r={idfum:a},t=s.get("TOKEN"),i='Bearer <\\"'+t+'\\">';$.ajax({async:!0,type:"POST",url:"https://pagonline.lapaz.bo/api/comprobantedepago",data:r,dataType:"json",crossDomain:!0,headers:{"cache-control":"no-cache"},headers:{authorization:i},success:function(a){var r=JSON.stringify(a),t=r.replace("Respuesta enviada","Respuestaenviada"),i=JSON.parse(t);joao=i,i.Respuestaenviada.idFum&&o.gDpl(e)},error:function(o){console.log("Error en funcion vdplepago",o)}})},o.vgDpl=function(e){var a={q:e.f};t({method:"POST",url:n.SERVICE_SITOLext+"vgdpl",data:Object.toparams(a),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(e,a,r,t){"OK"==e.res&&o.lstSolUnico()}).error(function(o,e,a,r){l.show("","Error al gen dpl","error"),console.log("Error en la funcion vgDpl",o)})},o.vlFum=function(){s.get("TOKEN")||o.loginPagoEnLinea();for(var e=0;e<o.solicitudesUsuario.length;e++)1==o.solicitudesUsuario[e].idEstado&&2==o.solicitudesUsuario[e].idTipoPago?o.vdplepago(o.solicitudesUsuario[e]):1==o.solicitudesUsuario[e].idEstado&&1==o.solicitudesUsuario[e].idTipoPago&&o.vgDpl(o.solicitudesUsuario[e])},o.lstSolUnico=function(){var e=(s.get("IDSOLICITANTE"),s.get("CICIUDADANO"));"JURIDICO"==s.get("TIPO_PERSONA")&&(e=s.get("NITCIUDADANO"));var a=new dataSITOL;a.dplLstSol(e,1,function(e){var a=JSON.parse(e);if(a.success){o.solicitudesUsuario=a.success.dataSql;a.success.dataSql;o.tablaSolicitudes.reload()}else l.show("","Error al recuperar datos","error"),console.log("Error en la funcion lstSolUnico",a.error.message)})},o.continuarPagoOL=function(o){s.set("IDFUM",o.FUM),window.location.href="#servicios|epagos"},o.solicitudesCiudadano=function(){$.blockUI();var e=(s.get("IDSOLICITANTE"),s.get("CICIUDADANO"));"JURIDICO"==s.get("TIPO_PERSONA")&&(e=s.get("NITCIUDADANO"));var a=new dataSITOL;a.dplLstSol(e,1,function(e){var a=JSON.parse(e);if(a.success){o.solicitudesUsuario=a.success.dataSql;a.success.dataSql;o.tablaSolicitudes.reload(),o.vlFum()}else l.show("","Error al recuperar datos","error"),console.log("Error en la funcion solicitudesCiudadano",a.error.message);$.unblockUI()})},o.tablaSolicitudes=new u({page:1,count:4,filter:{},sorting:{FechaRegistro:"desc"}},{total:o.solicitudesUsuario.length,getData:function(e,a){var r=a.filter()?p("filter")(o.solicitudesUsuario,a.filter()):o.solicitudesUsuario,t=a.sorting()?p("orderBy")(r,a.orderBy()):o.solicitudesUsuario;a.total(o.solicitudesUsuario.length),e.resolve(t.slice((a.page()-1)*a.count(),a.page()*a.count()))}}),o.CargarComboMotivos=function(){var e=new dataSITOL;e.dplLstMotivos(function(e){var a=JSON.parse(e);a.success?o.Motivos=a.success.dataSql:(l.show("","Error al recuperar datos","error"),console.log("Error en la funcion CargarComboMotivos",a.error.message))})},o.CargarComboMotivosDetalle=function(){o.idMotivoDetalle=0;var e=new dataSITOL;e.dplLstMotivosDet(o.idMotivo,function(e){var a=JSON.parse(e);a.success?o.MotivosDetalle=a.success.dataSql:(l.show("","Error al recuperar datos","error"),console.log("Error en la funcion CargarComboMotivosDetalle",a.error.message))})},o.recuperarDatosRegistro=function(){var e=new rcNatural;e.oid=s.get("IDCIUDADANO"),e.datosCiudadanoNatural(function(e){var a=JSON.parse(e);if(a.length>0){var r=a;switch(tipoPersona=r[0].dtspsl_tipo_persona,"NATURAL"==tipoPersona?(o.datospersonaNatural=null,o.datospersonaJuridica="ocultar",E.nombre=r[0].dtspsl_nombres,E.paterno=r[0].dtspsl_paterno,E.materno=r[0].dtspsl_materno,E.cedula=r[0].dtspsl_ci,E.expedido=r[0].dtspsl_expedido,E.sexo="M"==r[0].dtspsl_sexo?"MASCULINO":"FEMENINO",E.fecha_nacimiento=r[0].dtspsl_fec_nacimiento,E.ocupacion=r[0].dtspsl_ocupacion,E.direccion=r[0].dtspsl_direccion,E.correo=r[0].dtspsl_correo,E.telefono=r[0].dtspsl_telefono,E.celular=r[0].dtspsl_movil,angelNatural=E):(o.datospersonaJuridica=null,o.datospersonaNatural="ocultar",E.nombre=r[0].dtspsl_nombres,E.paterno=r[0].dtspsl_paterno,E.materno=r[0].dtspsl_materno,E.cedula=r[0].dtspsl_ci,E.repLegal=r[0].dtspsl_poder_replegal,E.nroNotaria=r[0].dtspsl_nro_notaria,E.nroDocumento=r[0].dtspsl_nro_documento,E.razonSocial=r[0].dtspsl_razon_social,E.telefono=r[0].dtspsl_telefono,E.celular=r[0].dtspsl_movil,E.correo=r[0].dtspsl_correo,E.nit=r[0].dtspsl_nit,E.direccion=r[0].dtspsl_direccion,E.nrocasa=r[0].dtspsl_numero_casa,E.nrooficina=r[0].dtspsl_oficina),E.expedido){case"1":E.expedido="CHQ";break;case"2":E.expedido="LPZ";break;case"3":E.expedido="CBB";break;case"4":E.expedido="ORU";break;case"5":E.expedido="PTS";break;case"6":E.expedido="TJA";break;case"7":E.expedido="SCZ";break;case"8":E.expedido="BNI";break;case"9":E.expedido="PND"}}else console.log("No se encontraron los datos del ciudadano!!",s.get("IDCIUDADANO"))})},o.lstCC=function(){o.lstCCciudadano=[];var e=s.get("CICIUDADANO");"JURIDICO"==s.get("TIPO_PERSONA")&&(e=s.get("NITCIUDADANO"));var a=new dataSIT;a.dplLstCC(e,function(e){var a=JSON.parse(e);a.success?o.lstCCciudadano=a.success.dataSql:console.log("Error en la funcion lstCC",a.error.message)})},o.VerificarDespliegueFUM=function(o){return 1==o.idEstado&1==o.idTipoPago},o.VerificarDespliegueEpago=function(o){return 1==o.idEstado&2==o.idTipoPago},o.VerificarDespliegueCC=function(o){return 2==o.idEstado||3==o.idEstado},o.codigoCatastral={distrito:null,manzana:null,predio:null,subpredio:null},o.CargarPopupBuscador=function(){o.codigoCatastral={},o.resultadoBusqueda={},o.confirmacionCiudadano=null,o.observacion.codigoCatastral="",o.observacion.obs="",o.cerrarProforma(),o.getCaptchasX()},o.BuscarCertificado=function(e){var a=document.getElementById("pdfView");a.addEventListener?(a.addEventListener("mousewheel",O,!1),a.addEventListener("DOMMouseScroll",O,!1)):a.attachEvent("onmousewheel",O),o.tipoVisor=1,o.varSpin=!0;var r=Padleft("000",o.codigoCatastral.distrito),t=Padleft("0000",o.codigoCatastral.manzana),i=Padleft("0000",o.codigoCatastral.predio);void 0==o.codigoCatastral.subpredio&&(o.codigoCatastral.subpredio=0);var d=Padleft("0000",o.codigoCatastral.subpredio),c=r+t+i+d,u=s.get("CICIUDADANO");o.observacion.codigoCatastral=r+"-"+t+"-"+i+"-"+d,"JURIDICO"==s.get("TIPO_PERSONA")&&(u=s.get("NITCIUDADANO")),o.resetUrl();var p=new dataSIT;p.dplBusCodCat(c,u,1,function(e){var a=JSON.parse(e);if(a.success){if(o.resultadoBusqueda=a.success.dataSql[0],o.resultadoBusqueda)if("OK"==o.resultadoBusqueda.res){var r=n.SERVICE_SITOLext+"DesplegarPreviewDpl?Dpl="+o.resultadoBusqueda.Dpl;$("#PDFtoPrint").attr("src",r),o.RefreshUrl(r),C(function(){o.varSpin=!1},2800),o.fit()}else $("#visorPreview object").attr("data",""),o.varSpin=!1;o.codigoCatastral={}}else l.show("","Error al buscar certificado","error"),o.spinner=!1,console.log("Error en la funcion BuscarCertificado",a.error.message);$.unblockUI()})},o.observacion={nomCiudadanoOEmpresa:s.get("US_NOMBRE")+" "+s.get("US_PATERNO")+" "+s.get("US_MATERNO"),nroDocumento:s.get("CICIUDADANO"),tipoPersoneria:s.get("TIPO_PERSONA"),email:s.get("US_EMAIL"),codigoCatastral:"",obs:""},"JURIDICO"==s.get("TIPO_PERSONA")&&(o.observacion.nomCiudadanoOEmpresa=s.get("US_NOMBRE"),o.observacion.nroDocumento=s.get("NITCIUDADANO")),o.EnviarObservacion=function(e){t({method:"POST",url:n.SERVICE_SITOLext+"RegObs",data:Object.toparams(e),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(o,e,a,r){}).error(function(o,e,a,r){l.show("","Error al enviar observacion","error")}),o.observacion.obs="",l.show("","Problemas de visualizaci√≥n enviados","success")},o.cargarDescripcionMotivos=function(){for(var e=0;e<o.Motivos.length;e++){var a=o.Motivos[e];if(a.IdMotivo==o.idMotivo){o.descMotivo=a.descripcion;break}}for(var e=0;e<o.MotivosDetalle.length;e++){var r=o.MotivosDetalle[e];if(r.IdMotivoDetalle==o.idMotivoDetalle){o.descMotivoDetalle=r.Descripcion;break}}},o.ImprimirProforma=function(e){o.varSpin=!0,o.RegistroFUM={registrado:"OK",mensaje:""};var a=n.SERVICE_SITOLext+"DesplegarFum?q="+e;$("#visorFum object").attr("data",a),C(function(){o.varSpin=!1},1e3)},o.impDpl=function(o){document.getElementById(o).focus(),document.getElementById(o).contentWindow.print()},o.ImprimirDpl=function(o){var e=n.SERVICE_SITOLext+"DesplegarDuplicado?a="+o;$("#visorDuplicado object").attr("data",e)},o.PrevCert=function(){},o.ConfimarcionCiudadano=function(){o.confirmacionCiudadano="OK"},o.proforma=!1,o.idMotivo=0,o.idMotivoDetalle=0,o.detalle={vista:!1,datos:{}},o.usuario={ap:"",am:"",nombre:"",email:"",ci:"",cel:""},o.scroll=0,o.loading="loading",o.getNavStyle=function(o){return o>100?"pdf-controls fixed":"pdf-controls"},o.tipoVisor=1,o.onError=function(o){},o.onLoad=function(){o.loading=""},o.onProgress=function(o){},o.resetUrl=function(){o.pdfUrl="../catastro/img/Default.pdf";var e="../catastro/img/Default.pdf";$("#PDFtoPrint").attr("src",e),o.RefreshUrl(e)},o.pdfUrl="../catastro/img/Default.pdf",o.ProformaPago=function(e){o.codigoCatastral={},o.idMotivo=0,o.idMotivoDetalle=0,o.descMotivo="",o.descMotivoDetalle="","OK"==e.res&&(o.proforma=!0)},o.cerrarProforma=function(){o.proforma=!1,o.idMotivoDetalle=0,o.idMotivo=0},o.cerrarDetalle=function(){o.detalle.vista=!1},o.verDetalle=function(e){o.detalle.vista=!0},o.genProforma=function(){if(o.Imp=!1,0==o.idMotivo||0==o.idMotivoDetalle)o.RegistroFUM={registrado:null,mensaje:"Debe seleccionar motivo y motivo detalle"};else{var e;e="NATURAL"==tipoPersona?{tipoDoc:"CEDULA DE IDENTIDAD",nroDoc:E.cedula,expedido:E.expedido,nombres:E.nombre,paterno:E.paterno,materno:E.materno,casada:"",fechanac:E.fecha_nacimiento,razonsocial:"RSN",tkn:o.resultadoBusqueda.tkn,cc:o.resultadoBusqueda.codCat}:{tipoDoc:"NIT",nroDoc:E.nit,expedido:E.expedido,nombres:E.razonSocial,paterno:"",materno:"",casada:"",fechanac:E.fecha_nacimiento,razonsocial:"RSJ",tkn:o.resultadoBusqueda.tkn,cc:o.resultadoBusqueda.codCat},t({method:"POST",url:n.SERVICE_SITOLext+"RegFUM",data:Object.toparams(e),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(e,a,r,t){if("OK"==e.res){var i=e.fum,d=e.msg,c=o.resultadoBusqueda.codCat,u="DUPLICADO",p="0",g=s.get("IDUSUARIO"),m=E.paterno+" "+E.materno,f=E.nombre,v=E.cedula,I=E.expedido,D="CI",C=i,S=o.idMotivo,O=o.idMotivoDetalle,_=c,U="0",M="0",T=d,h=o.idTipoPago,b="0",A="A";"NATURAL"!=tipoPersona&&(m=E.razonSocial,f=E.razonSocial,v=E.nit,I=E.expedido,D="NIT");var N=new dataSITOL;N.dplRegFum(u,p,g,m,f,v,I,D,C,S,O,_,U,M,T,h,b,A,function(e){var a=JSON.parse(e);if(a.success){o.solicitudesCiudadano(),o.idMotivo=0,o.idMotivoDetalle=0,o.RegistroFUM={registrado:"OK",mensaje:"Se√±or usuario, debe imprimir esta Proforma de Pago y apersonarse a cualquier entidad financiera autorizada en los siguientes 7 d√≠as calendario."};var r=n.SERVICE_SITOLext+"DesplegarFum?q="+d;$("object").css("display","none"),$("object").attr("data",r).css("display","");var t={};t="NATURAL"!=tipoPersona?{TipoTra:"DUPLICADO",OIDCiudadano:s.get("IDUSUARIO"),Apellidos:E.razonSocial,Nombres:E.razonSocial,NumeroDocumento:E.nit,Expedido:E.expedido,TipoDocumento:"NIT",FUM:i,IdMotivo:o.idMotivo,IdMotivoDetalle:o.idMotivoDetalle,CodigoCatastral:c}:{TipoTra:"DUPLICADO",OIDCiudadano:s.get("IDUSUARIO"),Apellidos:E.paterno+" "+E.materno,Nombres:E.nombre,NumeroDocumento:E.cedula,Expedido:E.expedido,TipoDocumento:"CI",FUM:i,IdMotivo:o.idMotivo,IdMotivoDetalle:o.idMotivoDetalle,CodigoCatastral:c},o.UpdateIntegra(t)}else l.show("","Error al registrar proforma","error"),console.log("Error al registrar proforma",a.error.message),o.idMotivoDetalle=0,o.idMotivo=0,o.RegistroFUM={registrado:null,mensaje:"Surgi√≥ un error al registrar la solicitud, por favor vuelva a intentar"}}),o.proforma=!1,o.resultadoBusqueda={}}else o.idMotivoDetalle=0,o.idMotivo=0,o.RegistroFUM={registrado:null,mensaje:"Surgi√≥ un error al registrar la proforma de pago, por favor vuelva a intentar"}}).error(function(o,e,a,r){l.show("","Error al registrar proforma de pago","error"),console.log("Error registro fum SIT ext, datos devueltos:",o)})}},o.genProformaPagoOL=function(){if(o.Imp=!1,0==o.idMotivo||0==o.idMotivoDetalle)o.RegistroFUM={registrado:null,mensaje:"Debe seleccionar motivo y motivo detalle"};else{var e;e="NATURAL"==tipoPersona?{tipoDoc:"CEDULA DE IDENTIDAD",nroDoc:E.cedula,expedido:E.expedido,nombres:E.nombre,paterno:E.paterno,materno:E.materno,casada:"",fechanac:E.fecha_nacimiento,razonsocial:"RSN",tkn:o.resultadoBusqueda.tkn,cc:o.resultadoBusqueda.codCat}:{tipoDoc:"NIT",nroDoc:E.nit,expedido:E.expedido,nombres:E.razonSocial,paterno:"",materno:"",casada:"",fechanac:E.fecha_nacimiento,razonsocial:"RSJ",tkn:o.resultadoBusqueda.tkn,cc:o.resultadoBusqueda.codCat},t({method:"POST",url:n.SERVICE_SITOLext+"RegFUM",data:Object.toparams(e),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(e,a,r,t){if("OK"==e.res){var i=e.fum,n=e.msg,d=o.resultadoBusqueda.codCat,c="DUPLICADO",u="0",p=s.get("IDUSUARIO"),g=E.paterno+" "+E.materno,m=E.nombre,f=E.cedula,v=E.expedido,I="CI",D=i,C=o.idMotivo,S=o.idMotivoDetalle,O=d,_="0",U="0",M=n,T=o.idTipoPago,h="0",b="A";"NATURAL"!=tipoPersona&&(g=E.razonSocial,m=E.razonSocial,f=E.nit,v=E.expedido,I="NIT");var A=new dataSITOL;A.dplRegFum(c,u,p,g,m,f,v,I,D,C,S,O,_,U,M,T,h,b,function(e){var a=JSON.parse(e);if(a.success){o.solicitudesCiudadano(),o.idMotivo=0,o.idMotivoDetalle=0,o.RegistroFUM={registrado:"OK",mensaje:"Se√±or usuario, debe imprimir esta Proforma de Pago y apersonarse a cualquier entidad financiera autorizada en los siguientes 7 d√≠as calendario."};var r={};r="NATURAL"!=tipoPersona?{TipoTra:"DUPLICADO",OIDCiudadano:s.get("IDUSUARIO"),Apellidos:E.razonSocial,Nombres:E.razonSocial,NumeroDocumento:E.nit,Expedido:E.expedido,TipoDocumento:"NIT",FUM:i,IdMotivo:o.idMotivo,IdMotivoDetalle:o.idMotivoDetalle,CodigoCatastral:d}:{TipoTra:"DUPLICADO",OIDCiudadano:s.get("IDUSUARIO"),Apellidos:E.paterno+" "+E.materno,Nombres:E.nombre,NumeroDocumento:E.cedula,Expedido:E.expedido,TipoDocumento:"CI",FUM:i,IdMotivo:o.idMotivo,IdMotivoDetalle:o.idMotivoDetalle,CodigoCatastral:d},o.UpdateIntegra(r),s.set("IDFUM",i),window.location.href="#servicios|epagos"}else l.show("","Error al registrar proforma de pago","error"),console.log("Error al registrar proforma de pago",a.error.message),o.idMotivoDetalle=0,o.idMotivo=0,o.RegistroFUM={registrado:null,mensaje:"Surgi√≥ un error al registrar la solicitud, por favor vuelva a intentar"}}),o.proforma=!1,o.resultadoBusqueda={}}else o.idMotivoDetalle=0,o.idMotivo=0,o.RegistroFUM={registrado:null,mensaje:"Surgi√≥ un error al registrar la proforma de pago, por favor vuelva a intentar"}}).error(function(o,e,a,r){l.show("","Error al registrar proforma de pago","error"),console.log("Error registro fum SIT ext, datos devueltos:",o)})}},o.DeplegarDpl=function(e){var a=document.getElementById("pdfView");a.addEventListener?(a.addEventListener("mousewheel",O,!1),a.addEventListener("DOMMouseScroll",O,!1)):a.attachEvent("onmousewheel",O),o.tipoVisor=2,o.varSpin=!0;var r=n.SERVICE_SITOLext+"DesplegarDuplicado?a="+e.a;o.RefreshUrl(r),C(function(){o.varSpin=!1},1e3),2==e.idEstado?(o.dspl=!0,$("#PDFtoPrint").attr("src",r)):o.dspl=!1,o.dplUrl=r,o.fit()},o.ErrorCapcha="",o.getlimpiareRROR=function(){o.ErrorCapcha=""},o.getCaptchasX=function(){var o=new captcha;o.obtcaptcha(function(o){json=JSON.parse(o),partes=json.success[0].sp_captcha_porx1.split(","),numero=partes[0].substring(1),i1=partes[2]+","+partes[3],i2=partes[4]+","+partes[5],document.getElementById("img2").src=i1.substring(1,i1.length-1),document.getElementById("img1").src=i2.substring(1,i2.length-2);var e="";"A"==partes[1]?e="AYMARA":"Q"==partes[1]?e="QUECHUA":"G"==partes[1]?e="GUARANI":"C"==partes[1]?e="CASTELLANO":console.log("Error en get CaptchaX",partes[1]),document.getElementById("img1").title="Palabra en "+e,document.getElementById("resultadoC").value="",document.getElementById("resultadoC").placeholder="Ingrese texto: "+e+" CASTELLANO",document.getElementById("lbllengua").placeholder="Ingrese texto: "+e+" CASTELLANO"})},o.VerificarCapcha=function(e){var a=$("#resultadoC").val(),r=numero,t=new captcha;t.identificador=r,t.respuesta=a,t.verificarCaptcha(function(a){json=JSON.parse(a),void 0==json.success[0]?(o.getCaptchasX(),o.codigoCatastral={},o.resultadoC="",o.ErrorCapcha="Vuelva registrar el capcha"):($("#divPopup").modal("hide"),$("#divPopup7").modal("show"),o.BuscarCertificado(e))})},o.AddIntegra=function(){o.RegistroFUM.mensaje="Generando..., espere por favor.";var e=new Date,a=e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()+" "+e.getHours()+":"+e.getMinutes()+":"+e.getSeconds();o.day=e.getDate();var r=e.getMonth()+2;r>11&&(r-=12),o.month=monthNames[r],o.year=e.getFullYear();var t=o.ConfIntegra.idServicio,i=s.get("IDSOLICITANTE"),n=a,d=new reglasnegocio;d.identificador="RCCIUDADANO_68",d.parametros='{"frm_tra_dvser_id":"'+t+'","frm_tra_id_ciudadano":"'+i+'","frm_tra_fecha":"'+n+'","frm_tra_enviado":"SI","frm_tra_id_usuario":"3"}',$.blockUI(),d.llamarregla(function(e){e=JSON.parse(e),o.ConfIntegra.idTramite=e.frm_tra_id,1==o.idTipoPago?($("#divPopup4").modal("show"),o.genProforma()):(o.genProformaPagoOL(),$("#divPopupPagoTarjeta").modal("show")),$.unblockUI()})},o.UpdateIntegra=function(e){var a=(I.obtenerFechaActual(),JSON.stringify(e),s.get("IDSOLICITANTE"),o.ConfIntegra.idTramite,o.ConfIntegra.idServicio,new reglasnegocio);a.identificador="RCCIUDADANO_80",a.parametros="{}",a.llamarregla(function(a){a=JSON.parse(a),o.AddIF(e)})},o.AddIF=function(e){var a=(o.ConfIntegra.idProcodigo,JSON.stringify(e)),r=new gCrearCaso;r.usr_id=1,r.datos=a,r.procodigo=o.ConfIntegra.idProcodigo,r.crearCasoAeLinea(function(o){$.unblockUI()})},o.$on("api:ready",function(){o.loginPagoEnLinea(),o.recuperarDatosRegistro(),o.CargarComboMotivos(),o.CargarComboMotivosDetalle(),o.solicitudesCiudadano(),o.registro3=E}),o.genAdj=function(){try{var e=new gDocumentos;e.doc_sistema="CATASTRO",e.doc_proceso=1,e.doc_id=1,e.doc_ci_nodo=1,e.doc_datos="",e.doc_url=o.dplUrl,e.doc_version=0,e.doc_tiempo=2,e.doc_firma_digital="",e.doc_usuario="Ciudadano",e.doc_tipo_documento="",e.doc_tamanio_documento="",e.doc_nombre="DuplicadoCatastral",e.doc_tps_doc_id=0,e.doc_url_logica=o.dplUrl,e.doc_acceso="",e.doc_tipo_documento_ext="",e.doc_nrotramite_nexo=0,e.doc_id_codigo=0,e.doc_titulo="",e.doc_palabras="",e.doc_registro="",e.doc_modificacion="",e.doc_estado="",e.doc_cuerpo="",e.doc_tipo_documentacion="",e.doc_tipo_ingreso="",e.doc_estado_de_envio="",e.doc_correlativo="",e.doc_id_carpeta=0;var a=new Date;a.getFullYear()+"-"+(a.getMonth()+1)+"-"+a.getDate()+" "+a.getHours()+":"+a.getMinutes()+":"+a.getSeconds();e.insertarDoc(function(e){var a=JSON.parse(e);a.success||($.unblockUI(),l.show(a.error.message)),o.dplUrl=""})}catch(e){o.dplUrl=""}}}app.filter("FormatoSercat",function(){return function(o){if(null!=o){if(15==o.length){var e=o,a=e.substring(0,3)+"-"+e.substring(3,7)+"-"+e.substring(7,11)+"-"+e.substring(11,15);return a}return o}}}),app.directive("vaCombo",function(){return{require:"ngModel",link:function(o,e,a,r){function t(o){return o.indexOf("e")>-1?r.$setValidity("charE",!0):r.$setValidity("charE",!1),o}r.$parsers.push(t)}}}),Object.toparams=function(o){var e=[];for(var a in o)e.push(a+"="+encodeURIComponent(o[a]));return e.join("&")};